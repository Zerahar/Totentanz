{"version":3,"sources":["js/Home.js","js/Info.js","js/AdminDashboard.js","js/PlayerDashboard.js","js/ChatList.js","js/Transactions.js","js/OpenChat.js","js/App.js","reportWebVitals.js","serviceWorkerRegistration.js","index.js"],"names":["NewsFeed","Home","class","alt","loading","Info","REACT_APP_SERVER_URL","process","AdminDashboard","props","editCharacter","bind","deleteCharacter","editUser","deleteUser","success","e","this","changeCharacter","characters","find","character","_id","target","id","changeUser","player","players","window","confirm","userName","isReady","fetch","headers","then","response","json","result","ok","error","catch","fetchCharacters","fetchPlayers","name","characterName","playerName","map","onClick","to","userType","login","admin","Component","Editor","editor","state","something","init","element","document","getElementById","type","onChange","html","changeEditor","actions","icon","title","getSelection","toString","linesToDelete","split","join","exec","formatBlock","execCommand","content","innerHTML","className","NewCharacter","age","gender","saldo","description","mechanics","plots","redirect","newId","handleChange","handleSubmit","checkInput","checkSuccess","event","value","checked","setState","preventDefault","oldPlayer","newPlayer","data","JSON","stringify","replace","parseFloat","url","method","mode","body","parsed","fail","forEach","part","counter","form","classList","add","checkValidity","length","clearSelectedCharacter","onSubmit","noValidate","maxLength","required","pattern","NewUser","selectedCharacter","isLoaded","validateForm","existingUser","fillFields","clearSelectedUser","minLength","placeholder","PlayerInfo","dangerouslySetInnerHTML","__html","Pay","amount","submit","warning","transaction","time","Date","now","user","recipient","statusText","options","PlayerDashboard","access","loggedCharacter","ChatList","chats","selectedCharacters","selectedChat","createChat","fetchChats","res","chat","newParticipants","participants","participant","push","a","prevState","filteredArray","filter","console","log","changeChat","index","array","removeChat","Transactions","history","toLocaleString","OpenChat","input","nameSent","ready","currentName","noMessages","sendMessage","messageBeingWritten","addMessage","WebSocket","MozWebSocket","Error","ws","characterId","readyState","wsInit","send","onmessage","evt","message","parse","newMessage","timeStyle","dateStyle","text","author","authorId","scrollTop","scrollHeight","msg","clear","header","noMessagesTip","require","REACT_APP_WS_SERVER_URL","App","userId","userCharacter","notifMsg","notifSender","selectedUser","defaultCharacter","logout","loginSuccess","showError","closeMenu","setReady","decodeURIComponent","cookie","charAt","substring","indexOf","sort","b","close","alert","setTimeout","remove","screen","width","navbar","Collapse","hide","onclose","toast","Toast","show","onopen","onerror","loginForm","for","playerPage","adminPage","role","data-bs-toggle","data-bs-target","aria-controls","aria-expanded","aria-label","aria-live","aria-atomic","exact","path","selectCharacter","selectUser","undefined","data-bs-dismiss","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","Boolean","location","hostname","match","ReactDOM","render","StrictMode","navigator","serviceWorker","registration","unregister"],"mappings":"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","file":"static/js/main.44d88af6.chunk.js","sourcesContent":["function NewsFeed() {\r\n    return (\r\n        <article>\r\n            <h3>Update 11/11/2021</h3>\r\n            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in.</p>\r\n        </article>\r\n    );\r\n}\r\n\r\nfunction Home() {\r\n    return (<div>\r\n        <figure class=\"front-image\" alt=\"Kuva mekaanikosta värikkäässä valaistuksessa\" loading=\"lazy\"></figure>\r\n        <main class=\"text-container front-container container\">\r\n\r\n            <h2>Home</h2>\r\n            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>\r\n            <div>\r\n                <NewsFeed />\r\n                <NewsFeed />\r\n            </div>\r\n        </main></div>\r\n    );\r\n}\r\nexport default Home","function Info() {\r\n  return (\r\n    <main class=\"text-container container\">\r\n      <h2>Info</h2>\r\n      <aside class=\"info-box\"><h3>Aikataulu</h3>\r\n        <ul>\r\n          <li>8:00 Paikka avautuu</li>\r\n          <li>10:00 Ilmoittautuminen</li>\r\n          <li>11:00 Peli-info</li>\r\n          <li>12:00 Peli alkaa</li>\r\n          <li>15:00 Artistin esiintyminen</li>\r\n          <li>17:00 Kasinoilta</li>\r\n          <li>21:00 Pääesiintyjä</li>\r\n        </ul>\r\n      </aside>\r\n      <p>Cyberpunk is a subgenre of science fiction in a dystopian futuristic setting that tends to focus on a \"combination of lowlife and high tech\"[1] featuring advanced technological and scientific achievements, such as artificial intelligence and cybernetics, juxtaposed with a degree of breakdown or radical change in the social order.[2] Much of cyberpunk is rooted in the New Wave science fiction movement of the 1960s and 1970s, when writers like Philip K. Dick, Roger Zelazny, John Brunner, J. G. Ballard, Philip José Farmer and Harlan Ellison examined the impact of drug culture, technology, and the sexual revolution while avoiding the utopian tendencies of earlier science fiction.</p>\r\n\r\n      <p>Comics exploring cyberpunk themes began appearing as early as Judge Dredd, first published in 1977.[3] Released in 1984, William Gibson's influential debut novel Neuromancer would help solidify cyberpunk as a genre, drawing influence from punk subculture and early hacker culture. Other influential cyberpunk writers included Bruce Sterling and Rudy Rucker. The Japanese cyberpunk subgenre began in 1982 with the debut of Katsuhiro Otomo's manga series Akira, with its 1988 anime film adaptation later popularizing the subgenre.</p>\r\n\r\n      <h3>Peliohjeet</h3>\r\n      <p>Early films in the genre include Ridley Scott's 1982 film Blade Runner, one of several of Philip K. Dick's works that have been adapted into films. The films Johnny Mnemonic (1995)[4] and New Rose Hotel (1998),[5][6] both based upon short stories by William Gibson, flopped commercially and critically. The Matrix trilogy (1999–2003) were some of the most successful cyberpunk films. Newer cyberpunk media includes Blade Runner 2049 (2017), a sequel to the original 1982 film, as well as Upgrade (2018), Alita: Battle Angel (2019) based on the 1990s Japanese manga Battle Angel Alita, the 2018 Netflix TV series Altered Carbon based on Richard K. Morgan's 2002 novel of the same name, and the video game Cyberpunk 2077 (2020), based on the table-top role-playing game Cyberpunk. </p>\r\n\r\n    </main>\r\n  );\r\n}\r\nexport default Info","// Import React dependencies.\r\nimport React, { Component } from 'react'\r\nimport { init, formatBlock, exec } from 'pell';\r\nimport { Link, Redirect } from \"react-router-dom\"\r\nimport 'pell/dist/pell.css'\r\nconst { REACT_APP_SERVER_URL } = process.env;\r\nclass AdminDashboard extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.editCharacter = this.editCharacter.bind(this);\r\n    this.deleteCharacter = this.deleteCharacter.bind(this)\r\n    this.editUser = this.editUser.bind(this)\r\n    this.deleteUser = this.deleteUser.bind(this)\r\n    this.success = this.success.bind(this)\r\n  }\r\n  editCharacter(e) {\r\n    this.props.changeCharacter(this.props.characters.find(character => character._id === e.target.id))\r\n  }\r\n  editUser(e) {\r\n    this.props.changeUser(e.target.id)\r\n  }\r\n  deleteUser(e) {\r\n    const player = this.props.players.find(player => player._id === e.target.id)\r\n    let c = window.confirm(\"Haluatko varmasti poistaa käyttäjän \" + player.userName + \"?\")\r\n    if (c) {\r\n      this.props.isReady(false)\r\n      fetch(REACT_APP_SERVER_URL + \"user/delete/\" + e.target.id, { headers: { 'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com' } })\r\n        .then(response => response.json())\r\n        .then(result => result.ok === 1 ? this.success() : this.props.error(\"Käyttäjän poisto ei onnistunut.\"))\r\n        .catch(error => this.props.error(error, \"danger\"))\r\n    }\r\n  }\r\n  success() {\r\n    this.props.error(\"Poisto onnistui!\", \"success\")\r\n    this.props.fetchCharacters()\r\n    this.props.fetchPlayers()\r\n  }\r\n  deleteCharacter(e) {\r\n    const character = this.props.characters.find(character => character._id === e.target.id)\r\n    let c = window.confirm(\"Haluatko varmasti poistaa hahmon \" + character.name + \"?\")\r\n    if (c) {\r\n      this.props.isReady(false)\r\n      fetch(REACT_APP_SERVER_URL + \"character/delete/\" + e.target.id, { headers: { 'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com' } })\r\n        .then(response => response.json())\r\n        .then(result => result.ok === 1 ? this.success() : this.props.error(\"Käyttäjän poisto ei onnistunut.\"))\r\n        .catch(error => this.props.error(error, \"danger\"))\r\n    }\r\n  }\r\n  componentDidMount() {\r\n    this.props.fetchCharacters()\r\n    this.props.fetchPlayers()\r\n  }\r\n  render() {\r\n    const characterName = (characters, id) => { if (id) { try { return characters.find(character => character._id === id).name } catch { return \"-\" } } else { return \"-\" } }\r\n    const playerName = (players, id) => { if (id) { try { return players.find(player => player._id === id).userName } catch { return \"-\" } } else { return \"-\" } }\r\n    const characters = this.props.characters.map((character) => <tr key={character._id}>\r\n      <td>{character.name}</td><td>{playerName(this.props.players, character.player)}</td>\r\n      <td class=\"table-operations\">\r\n        <Link id={character._id} onClick={this.editCharacter} to=\"admin/newCharacter\" class=\"btn btn-primary flex-fill m-2 w-100\">Muokkaa</Link>\r\n        <button id={character._id} onClick={this.deleteCharacter} class=\"btn btn-danger flex-fill m-2 w-100\">Poista</button></td>\r\n    </tr>);\r\n    let players = null\r\n    if (this.props.players)\r\n      players = this.props.players.map((player) => player.userType === \"player\" ? <tr key={player._id}>\r\n        <td>{player.userName}</td>\r\n        <td>{characterName(this.props.characters, player.character)}</td>\r\n        <td>{player.login}</td>\r\n        <td class=\"table-operations\"><Link id={player._id} onClick={this.editUser} to=\"admin/newUser\" class=\"btn btn-primary flex-fill m-2 w-100\">Muokkaa</Link>\r\n          <button id={player._id} onClick={this.deleteUser} class=\"btn btn-danger flex-fill m-2 w-100\">Poista</button></td>\r\n      </tr> : null);\r\n    if (this.props.admin === \"admin\")\r\n      return (\r\n        <main class=\"text-container container\">\r\n          <nav class=\"nav justify-content-center\">\r\n            <Link to=\"admin/transactions\" class=\"nav-item\">Maksutapahtumat</Link>\r\n            <Link to=\"admin/messages\" class=\"nav-item\">Keskustelut</Link>\r\n            <Link to=\"admin/newUser\" class=\"nav-item\">Uusi käyttäjä</Link>\r\n            <Link to=\"admin/newCharacter\" class=\"nav-item\">Uusi hahmo</Link>\r\n          </nav>\r\n          <h2>Hahmot</h2>\r\n          <table class=\"table table-dark w-100\">\r\n            <thead>\r\n              <tr><th>Nimi</th><th>Pelaaja</th><th class=\"w-25\">Operaatiot</th></tr>\r\n            </thead>\r\n            <tbody>{characters}</tbody>\r\n          </table>\r\n\r\n          <h2>Pelaajat</h2>\r\n          <table class=\"table table-dark w-100\">\r\n            <thead>\r\n              <tr><th>Oikea nimi</th><th>Hahmon nimi</th><th>Tunnus</th><th class=\"w-25\">Operaatiot</th></tr>\r\n            </thead>\r\n            <tbody>{players}</tbody>\r\n          </table>\r\n        </main>\r\n      )\r\n    else\r\n      return (\r\n        <main class=\"text-container container\"><p>Kirjaudu sisään nähdäksesi adminin työkalut.</p></main>\r\n      )\r\n  }\r\n}\r\n\r\nclass Editor extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      something: ''\r\n    }\r\n  }\r\n  editor = null\r\n  componentDidMount() {\r\n    this.editor = init({\r\n      element: document.getElementById('editor-' + this.props.type),\r\n      onChange: html => this.props.changeEditor(html),\r\n      actions: ['bold', 'underline', 'italic', 'heading1', 'heading2', 'ulist', {\r\n        name: 'erase',\r\n        icon: 'X',\r\n        title: 'Poista muotoilut',\r\n        result: () => {\r\n          if (window.getSelection().toString()) {\r\n            let linesToDelete = window.getSelection().toString().split('\\n').join('<br>');\r\n            exec(formatBlock, '<div>');\r\n            document.execCommand('insertHTML', false, '<div>' + linesToDelete + '</div>');\r\n          } else {\r\n            exec(formatBlock, '<div>')\r\n          }\r\n        }\r\n      },],\r\n    })\r\n    this.editor.content.innerHTML = this.props.html\r\n  }\r\n  render() {\r\n    return (\r\n      <div id={\"editor-\" + this.props.type} className=\"pell\" />\r\n    )\r\n  }\r\n}\r\n\r\nexport class NewCharacter extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      name: this.props.character.name,\r\n      age: this.props.character.age,\r\n      gender: this.props.character.gender,\r\n      player: this.props.character.player,\r\n      saldo: this.props.character.saldo,\r\n      description: this.props.character.description,\r\n      mechanics: this.props.character.mechanics,\r\n      plots: this.props.character.plots,\r\n      redirect: '',\r\n      newId: '',\r\n      error: ''\r\n    };\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n    this.checkInput = this.checkInput.bind(this)\r\n    this.checkSuccess = this.checkSuccess.bind(this)\r\n  }\r\n  handleChange(event) {\r\n    const target = event.target;\r\n    const value = target.type === 'checkbox' ? target.checked : target.value;\r\n    const name = target.name;\r\n    this.setState({\r\n      [name]: value\r\n    });\r\n  }\r\n  handleSubmit(event) {\r\n    event.preventDefault();\r\n    if (this.checkInput()) {\r\n      this.props.isReady(false)\r\n      let newPlayer = false\r\n      let oldPlayer\r\n      if (this.props.character.player !== this.state.player && this.state.player)\r\n        newPlayer = true\r\n      if (this.props.character.player && this.props.character.player !== this.state.player)\r\n        oldPlayer = this.props.players.find(player => player._id === this.props.character.player)._id\r\n      const data = JSON.stringify({\r\n        name: this.state.name.replace(/[\"=';]/g, \"\"), // Clean input just to be sure\r\n        age: this.state.age.replace(/[\\D]/g, \"\"),\r\n        gender: this.state.gender.replace(/[\"=';]/g, \"\"),\r\n        player: this.state.player,\r\n        saldo: parseFloat(this.state.saldo),\r\n        description: this.state.description,\r\n        mechanics: this.state.mechanics,\r\n        plots: this.state.plots,\r\n        newPlayer: newPlayer,\r\n        oldPlayer: oldPlayer\r\n      })\r\n      let url = REACT_APP_SERVER_URL + \"character/\"\r\n      if (this.props.character._id)\r\n        url += this.props.character._id\r\n      // Insert/update character\r\n      fetch(url, {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n          , 'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com'\r\n        },\r\n        body: data\r\n      })\r\n        .then(response => response.json())\r\n        .then(parsed => this.checkSuccess(parsed))\r\n        .catch(error => this.props.error(error, \"danger\"))\r\n    }\r\n  }\r\n  checkSuccess(result) {\r\n    let fail = false\r\n    this.props.isReady(true)\r\n    result.forEach((part, counter) => {\r\n      if (part !== null && part.ok !== 1) {\r\n        this.props.error(\"Hahmon lisäys ei onnistunut.\")\r\n        fail = true\r\n        return\r\n      }\r\n    })\r\n    if (!fail)\r\n      this.setState({ redirect: <Redirect to=\"/admin\" /> })\r\n  }\r\n  checkInput() {\r\n    const form = document.getElementById('characterForm')\r\n    form.classList.add(\"was-validated\")\r\n    if (!form.checkValidity())\r\n      this.props.error(\"Kentissä oli virheitä.\", true)\r\n    return form.checkValidity()\r\n  }\r\n  componentDidMount() {\r\n    if (this.props.players.length === 0)\r\n      this.props.fetchPlayers()\r\n  }\r\n  componentWillUnmount() {\r\n    this.props.clearSelectedCharacter()\r\n  }\r\n  render() {\r\n    const players = this.props.players.map(player => <option value={player._id} key={player._id}>{player.userName}</option>)\r\n    return (\r\n      <main class=\"text-container container\">\r\n        <form onSubmit={this.handleSubmit} noValidate id=\"characterForm\">\r\n          <div class=\"mb-3\">\r\n            <label class=\"form-label\">Nimi:</label>\r\n            <input class=\"form-control\" maxLength=\"30\" required pattern=\"[ .,\\-'a-öA-Ö\\d]*\" type=\"text\" value={this.state.name} onChange={this.handleChange} name=\"name\"></input>\r\n            <div class=\"invalid-feedback\">\r\n              Hahmolla täytyy olla nimi, ja ainoat sallitut erikoismerkit ovat .,-' ja numerot.\r\n            </div>\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label class=\"form-label\">Ikä:</label> <input class=\"form-control\" pattern=\"[\\d]*\" type=\"text\" value={this.state.age} onChange={this.handleChange} name=\"age\"></input>\r\n            <div class=\"invalid-feedback\">\r\n              Iän täytyy olla numero.\r\n            </div>\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label class=\"form-label\">Sukupuoli:</label> <input class=\"form-control\" pattern=\"[a-öA-Ö]*\" type=\"text\" value={this.state.gender} onChange={this.handleChange} name=\"gender\"></input>\r\n            <div class=\"invalid-feedback\">\r\n              Sukupuoli ei voi sisältää numeroita tai erikoismerkkejä.\r\n            </div>\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label class=\"form-label\">Pelaaja:</label> <select class=\"form-select\" value={this.state.player} onChange={this.handleChange} name=\"player\">\r\n              <option value=\"\" >-</option>{players}</select>\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label class=\"form-label\">Saldo:</label> <input class=\"form-control\" pattern=\"^[\\d]+(,\\d\\d)*\" type=\"text\" value={this.state.saldo} onChange={this.handleChange} name=\"saldo\"></input>\r\n            <div class=\"invalid-feedback\">\r\n              Saldon täytyy olla numero. Senttien erottimena käytetään pilkkua.\r\n            </div>\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label class=\"form-label\">Kuvaus: </label>\r\n            <Editor changeEditor={(data) => this.setState({ description: data })} html={this.state.description} type=\"description\" />\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label class=\"form-label\">Juonet: </label>\r\n            <Editor changeEditor={(data) => this.setState({ plots: data })} html={this.state.plots} type=\"plots\" />\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label class=\"form-label\">Pelimekaniikat: </label>\r\n            <Editor changeEditor={(data) => this.setState({ mechanics: data })} html={this.state.mechanics} type=\"mechanics\" />\r\n          </div>\r\n          <button type=\"submit\" onClick={this.handleSubmit} class=\"btn btn-primary\">Tallenna</button>\r\n          <Link to=\"/admin\" class=\"btn btn-warning m-3\">Poistu tallentamatta</Link>\r\n        </form>\r\n        {this.state.redirect}\r\n      </main>\r\n    );\r\n  }\r\n}\r\nexport class NewUser extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      login: '',\r\n      playerName: '',\r\n      selectedCharacter: '',\r\n      isLoaded: true,\r\n      redirect: ''\r\n    };\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n    this.validateForm = this.validateForm.bind(this)\r\n  }\r\n  handleChange(event) {\r\n    const target = event.target;\r\n    const value = target.type === 'checkbox' ? target.checked : target.value;\r\n    const name = target.name;\r\n    this.setState({\r\n      [name]: value\r\n    });\r\n  }\r\n  handleSubmit(event) {\r\n    event.preventDefault();\r\n    if (this.validateForm()) {\r\n      this.props.isReady(false)\r\n      const data = {\r\n        login: this.state.login.replace(/[\"=';]/g, \"\"),\r\n        userName: this.state.playerName.replace(/[\"=';]/g, \"\"),\r\n        character: this.state.selectedCharacter,\r\n        userType: 'player'\r\n      }\r\n      let url = REACT_APP_SERVER_URL + \"user/\"\r\n      if (this.props.existingUser)\r\n        url += this.props.existingUser._id\r\n\r\n      fetch(url, {\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com'\r\n        },\r\n        body: JSON.stringify(data)\r\n      })\r\n        .then(response => { this.setState({ redirect: <Redirect to=\"/admin\" /> }); this.props.isReady(true) })\r\n        .catch(error => this.props.error(error, \"danger\"))\r\n    }\r\n  }\r\n  validateForm() {\r\n    const form = document.getElementById('userForm')\r\n    form.classList.add(\"was-validated\")\r\n    return form.checkValidity()\r\n  }\r\n  fillFields() {\r\n    this.setState({\r\n      login: this.props.existingUser.login,\r\n      playerName: this.props.existingUser.userName,\r\n      selectedCharacter: this.props.existingUser.character\r\n    })\r\n  }\r\n  componentDidMount() {\r\n    if (this.props.existingUser)\r\n      this.fillFields()\r\n  }\r\n  componentWillUnmount() {\r\n    this.props.clearSelectedUser()\r\n  }\r\n  render() {\r\n    const characters = this.props.characters.map((character) => <option value={character._id} key={character._id}>{character.name}</option>)\r\n    return (\r\n      <main class=\"text-container container\">\r\n        <form onSubmit={this.handleSubmit} noValidate id=\"userForm\">\r\n          <div class=\"mb-3\">\r\n            <label class=\"form-label\">* Kirjautumistunnus</label>\r\n            <input\r\n              minLength=\"6\"\r\n              maxLength=\"20\"\r\n              required\r\n              pattern=\"[a-öA-Ö\\d]*\"\r\n              id=\"loginInput\"\r\n              class=\"form-control\"\r\n              type=\"text\"\r\n              name=\"login\"\r\n              value={this.state.login}\r\n              onChange={this.handleChange}\r\n              placeholder=\"Käyttäjän kirjautumiseen käyttämä tunnus\"\r\n            ></input>\r\n            <div class=\"invalid-feedback\" id=\"loginFeedback\">\r\n              Tarkista, että kirjautumistunnus on vähintään 6 merkkiä pitkä ja sisältää ainoastaan kirjaimia ja numeroita.\r\n            </div>\r\n          </div><div class=\"mb-3\">\r\n            <label class=\"form-label\">* Pelaajan nimi</label>\r\n            <input minLength=\"3\" maxLength=\"30\" required pattern=\"[ .,\\-'a-öA-Ö\\d]*\" id=\"nameInput\" class=\"form-control\" type=\"text\" name=\"playerName\" value={this.state.playerName} onChange={this.handleChange}></input>\r\n            <div class=\"invalid-feedback\" id=\"nameFeedback\">\r\n              Nimi on pakollinen tieto ja se voi sisältää ainoastaan kirjaimia ja seuraavia merkkejä: ,.'-\r\n            </div>\r\n          </div><div class=\"mb-3\">\r\n            <label class=\"form-label\">Hahmo</label><select class=\"form-select\" name=\"selectedCharacter\" value={this.state.selectedCharacter} onChange={this.handleChange}><option value=\"\" key=\"none\">-</option>{characters}</select>\r\n          </div>\r\n          <button type=\"submit\" class=\"btn btn-primary\">Tallenna</button>\r\n          <Link to=\"/admin\" class=\"btn btn-warning m-3\">Poistu tallentamatta</Link>\r\n        </form>\r\n        {this.state.redirect}\r\n      </main>\r\n    )\r\n  }\r\n}\r\n\r\nexport default AdminDashboard","import { Component } from \"react\";\r\nimport { Link, Redirect } from \"react-router-dom\"\r\nconst { REACT_APP_SERVER_URL } = process.env;\r\n\r\nexport class PlayerInfo extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            name: '',\r\n            age: '',\r\n            gender: '',\r\n            saldo: '',\r\n            description: 'Hahmon kuvaus',\r\n            mechanics: 'Pelimekaniikat',\r\n            plots: 'Juonet'\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        if (this.props.character) {\r\n            this.setState({ name: this.props.character.name })\r\n            this.setState({ age: this.props.character.age })\r\n            this.setState({ gender: this.props.character.gender })\r\n            this.setState({ saldo: this.props.character.saldo })\r\n            this.setState({ description: this.props.character.description })\r\n            this.setState({ plots: this.props.character.plots })\r\n            this.setState({ mechanics: this.props.character.mechanics })\r\n        }\r\n    }\r\n    render() {\r\n        return (\r\n            <main class=\"text-container container\">\r\n                <h2>Info</h2>\r\n                <ul>\r\n                    <li>Nimi: {this.state.name}</li>\r\n                    <li>Ikä: {this.state.age}</li>\r\n                    <li>Sukupuoli: {this.state.gender}</li>\r\n                    <li>Saldo: {this.state.saldo}</li>\r\n                </ul>\r\n                <h3>Kuvaus</h3>\r\n                <div dangerouslySetInnerHTML={{ __html: this.state.description }} />\r\n                <h3>Juonet</h3>\r\n                <div dangerouslySetInnerHTML={{ __html: this.state.plots }} />\r\n                <h3>Pelimekaniikat</h3>\r\n                <div dangerouslySetInnerHTML={{ __html: this.state.mechanics }} />\r\n            </main>\r\n        );\r\n    }\r\n}\r\n\r\nexport class Pay extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            amount: 0,\r\n            selectedCharacter: '',\r\n            redirect: ''\r\n        }\r\n        this.submit = this.submit.bind(this)\r\n        this.handleChange = this.handleChange.bind(this)\r\n        this.checkSuccess = this.checkSuccess.bind(this)\r\n    }\r\n    submit(e) {\r\n        e.preventDefault()\r\n        if (this.state.amount < 0)\r\n            this.setState({ warning: \"Virheellinen summa\" })\r\n        else if (this.state.amount > this.props.character.saldo)\r\n            this.setState({ warning: \"Tililläsi ei ole tarpeeksi saldoa\" })\r\n        else if (!this.state.selectedCharacter)\r\n            this.setState({ warning: \"Valitse maksun saaja\" })\r\n        else {\r\n            let c = window.confirm(\"Haluatko maksaa \" + this.state.amount + \" eurodollaria kohteelle \" +\r\n                this.props.characters.find(character => character._id === this.state.selectedCharacter).name + \"?\")\r\n            if (c) {\r\n                this.props.isReady(false)\r\n                const transaction = JSON.stringify({\r\n                    time: Date.now(),\r\n                    user: this.props.character._id,\r\n                    recipient: this.state.selectedCharacter,\r\n                    amount: this.state.amount\r\n                })\r\n                fetch(REACT_APP_SERVER_URL, {\r\n                    method: 'POST',\r\n                    mode: 'cors',\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                        'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com'\r\n                    },\r\n                    body: transaction\r\n                })\r\n                    .then(response => response.json())\r\n                    .then(result => this.checkSuccess(result))\r\n                    .catch(error => this.props.error(error, \"danger\"))\r\n            }\r\n        }\r\n    }\r\n    handleChange(event) {\r\n        const target = event.target;\r\n        const value = target.value;\r\n        const name = target.name;\r\n        this.setState({\r\n            [name]: value\r\n        });\r\n    }\r\n    checkSuccess(response) {\r\n        this.props.isReady(true)\r\n        response.forEach((part, counter) => {\r\n            if (part.ok !== 1) {\r\n                this.setState({ warning: response.statusText })\r\n                return\r\n            }\r\n            // All clear, proceed\r\n            else if (counter === 2) {\r\n                this.props.fetchCharacters()\r\n                this.setState({\r\n                    amount: 0,\r\n                    selectedCharacter: ''\r\n                })\r\n                this.props.error(\"Maksu onnistui!\", \"success\")\r\n            }\r\n        });\r\n    }\r\n    componentWillMount() {\r\n        // Handle page refresh\r\n        if (!this.props.character)\r\n            this.setState({ redirect: <Redirect to=\"/dashboard\" /> })\r\n    }\r\n    render() {\r\n        const options = this.props.characters.map((character) => { if (character._id !== this.props.character._id) return <option value={character._id}>{character.name}</option>; else return null });\r\n        let saldo = \"???\"\r\n        if (this.props.character && this.props.character.saldo)\r\n            saldo = this.props.character.saldo\r\n        return (\r\n            <main class=\"text-container container\">\r\n                {this.state.redirect}\r\n                <h2>Pay</h2>\r\n                {this.state.success}\r\n                <p>Sinulla on <strong>{saldo}</strong> eurodollaria.</p>\r\n                <form onSubmit={this.submit}>\r\n                    <div class=\"mb-3\">\r\n                        <label class=\"form-label\">Vastaanottaja</label>\r\n                        <select class=\"form-select\" name=\"selectedCharacter\" value={this.state.selectedCharacter} onChange={this.handleChange}>\r\n                            <option value=\"\">-</option>{options}</select>\r\n                    </div>\r\n                    <div class=\"mb-3\">\r\n                        <label class=\"form-label\">Summa</label>\r\n                        <input class=\"form-control\" name=\"amount\" required value={this.state.amount} onChange={this.handleChange}></input>\r\n                    </div>\r\n                    <span>{this.state.warning}</span>\r\n                    <button type=\"submit\" class=\"btn btn-primary\">Maksa</button>\r\n                </form>\r\n            </main>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nexport class PlayerDashboard extends Component {\r\n    componentDidMount() {\r\n        this.props.fetchCharacters()\r\n    }\r\n    render() {\r\n        let access = <p>Kirjaudu sisään nähdäksesi hahmotietosi</p>\r\n        if (this.props.userType === \"player\" && !this.props.loggedCharacter)\r\n            access = <p>Sinulle ei ole vielä annettu hahmoa. Yritä uudelleen myöhemmin tai ota yhteys pelinjohtoon.</p>\r\n        else if (this.props.loggedCharacter)\r\n            access = <div class=\"d-flex player-controls\">\r\n                <div class=\"flex-fill d-flex p-3\">\r\n                    <Link to=\"dashboard/pay\" class=\"btn btn-primary flex-fill fs-5\">Maksa</Link>\r\n                </div>\r\n                <div class=\"flex-fill d-flex p-3\">\r\n                    <Link to=\"dashboard/info\" class=\"btn btn-primary flex-fill fs-5\">Info</Link>\r\n                </div>\r\n                <div class=\"flex-fill d-flex p-3\">\r\n                    <Link to=\"dashboard/chat\" class=\"btn btn-primary flex-fill fs-5\">Viestit</Link>\r\n                </div></div>\r\n        return (\r\n            <main class=\"text-container container\">\r\n                <h2>Omat tiedot</h2>\r\n                {access}\r\n            </main>\r\n        )\r\n    }\r\n}\r\n\r\nexport default PlayerInfo;\r\n","import { Component } from \"react\";\r\nimport { Link } from \"react-router-dom\"\r\nimport { Trash } from 'react-bootstrap-icons'\r\nconst { REACT_APP_SERVER_URL } = process.env;\r\nclass ChatList extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            chats: [],\r\n            mode: '',\r\n            isLoaded: false,\r\n            error: '',\r\n            selectedCharacters: [],\r\n            selectedChat: '',\r\n            warning: ''\r\n        }\r\n        this.handleChange = this.handleChange.bind(this)\r\n        this.createChat = this.createChat.bind(this)\r\n        this.fetchChats = this.fetchChats.bind(this)\r\n    }\r\n    componentDidMount() {\r\n        this.fetchChats()\r\n    }\r\n    fetchChats() {\r\n        let url = REACT_APP_SERVER_URL + \"chat/\"\r\n        if (this.props.loggedCharacter)\r\n            url += this.props.loggedCharacter\r\n        // If player has a character, fetch chats where they are participating. \r\n        // If admin, fetch all chats.\r\n        if (this.props.loggedCharacter || this.props.type === \"admin\") {\r\n            this.props.isReady(false)\r\n            fetch(url, { headers: { 'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com' } })\r\n                .then(res => res.json())\r\n                .then(\r\n                    (result) => {\r\n                        // fill character names into chats\r\n                        result.forEach(chat => {\r\n                            let newParticipants = []\r\n                            chat.participants.forEach(participant => newParticipants.push({ _id: participant, name: this.props.characters.find(a => a._id == participant).name }))\r\n                            chat.participants = newParticipants\r\n                        })\r\n                        this.setState({ chats: result, isLoaded: true });\r\n                        this.props.isReady(true)\r\n                    }\r\n                )\r\n                .catch(error => this.props.error(error, \"danger\"))\r\n        }\r\n        else if (this.props.type === \"guest\")\r\n            this.setState({ warning: 'Kirjaudu sisään nähdäksesi keskustelut.' })\r\n        else\r\n            this.setState({ warning: 'Sinulle ei ole asetettu omaa hahmoa. Ota yhteyttä pelinjohtoon.' })\r\n    }\r\n    handleChange(event) {\r\n        if (event.target.checked)\r\n            this.setState(prevState => ({ selectedCharacters: [...prevState.selectedCharacters, this.props.characters.find(character => character._id === event.target.name)] }))\r\n        else {\r\n            let filteredArray = this.state.selectedCharacters.filter(character => character._id !== event.target.name)\r\n            this.setState({ selectedCharacters: filteredArray })\r\n        }\r\n    }\r\n    createChat() {\r\n        const loggedCharacter = this.props.characters.find(character => character._id === this.props.loggedCharacter)\r\n        let characters = []\r\n        if (loggedCharacter)\r\n            characters = [loggedCharacter._id]\r\n        this.state.selectedCharacters.map(character => characters.push(character._id))\r\n        const data = JSON.stringify({ participants: characters })\r\n        fetch(REACT_APP_SERVER_URL + \"chat/\", {\r\n            method: 'POST',\r\n            mode: 'cors',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com'\r\n            },\r\n            body: data\r\n        })\r\n            .then(response => response.json())\r\n            .then(result => result.ok === 1 ? this.fetchChats() : this.props.error(\"Chatin luonti ei onnistunut.\"))\r\n            .catch(error => this.props.error(error, \"danger\"))\r\n        this.setState({ mode: '', selectedCharacters: [] })\r\n    }\r\n    removeChat(chat) {\r\n        console.log(chat)\r\n        let c = window.confirm(\"Haluatko poistaa keskustelun, jossa jäseninä ovat \" + chat.participants.map(a => a.name) + \"?\")\r\n        if (c) {\r\n            fetch(REACT_APP_SERVER_URL + \"chat/delete/\" + chat._id, {\r\n                method: 'GET',\r\n                mode: 'cors',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com'\r\n                }\r\n            })\r\n                .then(response => response.json())\r\n                .then(result => result.ok === 1 ? this.fetchChats() : this.props.error(\"Chatin poisto ei onnistunut.\"))\r\n                .catch(error => this.props.error(error, \"danger\"))\r\n        }\r\n    }\r\n    render() {\r\n        const characters = this.props.characters.filter(character => character._id !== this.props.loggedCharacter).map((character) =>\r\n            <div class=\"row\">\r\n                <div class=\"col-auto\">\r\n                    <input type=\"checkbox\" class=\"form-check-input\" name={character._id} onChange={this.handleChange} />\r\n                </div>\r\n                <div class=\"col-auto\">\r\n                    <label class=\"form-check-label\">{character.name}</label>\r\n                </div>\r\n            </div>)\r\n        const chats = this.state.chats.map((chat) =>\r\n            <Link to=\"/chat\"\r\n                onClick={() => this.props.changeChat(chat)}\r\n                class=\"no-decoration\"><li id={chat._id} class=\"list-group-item chat-list-item d-flex justify-content-between align-items-center\">\r\n                    {/* Filter current user's name and then show all other participants in a chat */}\r\n                    {chat.participants\r\n                        .filter(a => a._id != this.props.loggedCharacter)\r\n                        .map((participant, index, array) => index === array.length - 1 ? participant.name : participant.name + \", \")}\r\n                    {this.props.type == \"admin\" ? <button class=\"btn btn-danger\" onClick={() => this.removeChat(chat)}><Trash /></button> : \"\"}\r\n                </li></Link>\r\n\r\n        );\r\n        if (this.state.mode === \"new\") {\r\n            return (<main class=\"text-container container\">\r\n                <h2>Valitse keskustelun jäsenet</h2>\r\n                {characters}\r\n                <br />\r\n                <button onClick={this.createChat} class=\"btn btn-primary\">Luo keskustelu</button>\r\n            </main>)\r\n        }\r\n        else {\r\n            return (\r\n                <main class=\"text-container container\">\r\n                    <h2>Keskustelut</h2>\r\n                    <p>{this.state.warning}</p>\r\n                    <button onClick={() => this.setState({ mode: \"new\" })} class=\"btn btn-primary\">Uusi keskustelu</button>\r\n                    <br />\r\n                    <ul class=\"list-group chat-list\">{chats}</ul>\r\n                </main>\r\n            )\r\n        }\r\n    }\r\n}\r\n\r\nexport default ChatList;","import { Component } from \"react\";\r\nconst { REACT_APP_SERVER_URL } = process.env;\r\nclass Transactions extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            history: []\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        this.props.isReady(false)\r\n        if (this.props.characters.length === 0)\r\n            this.props.fetchCharacters()\r\n        fetch(REACT_APP_SERVER_URL + \"transaction/\", { headers: { 'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com' } })\r\n            .then(res => res.json())\r\n            .then(\r\n                (result) => {\r\n                    this.setState({\r\n                        history: result\r\n                    });\r\n                    this.props.isReady(true)\r\n                })\r\n            .catch(error => this.props.error(error, \"danger\"))\r\n    }\r\n    render() {\r\n        const history = this.state.history.map(event => {\r\n            let user = this.props.characters.find(character => character._id === event.user)\r\n            let recipient = this.props.characters.find(character => character._id === event.recipient)\r\n            // If characters match, use their names\r\n            user ? user = user.name : user = \"\"\r\n            recipient ? recipient = recipient.name : recipient = \"\"\r\n            return <tr id={event._id}>\r\n                <td>{user}</td>\r\n                <td>{recipient}</td>\r\n                <td>{event.amount}</td>\r\n                <td>{new Date(event.time).toLocaleString(\"fi-FI\")}</td>\r\n            </tr>\r\n        })\r\n        return (\r\n            <main class=\"text-container container\">\r\n                <h2>Maksutapahtumat</h2>\r\n                <table class=\"table transactions-table\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Maksaja</th>\r\n                            <th>Kohde</th>\r\n                            <th>Summa</th>\r\n                            <th>Aika</th>\r\n                        </tr></thead><tbody>\r\n                        {history}\r\n                    </tbody></table>\r\n            </main>\r\n        )\r\n    }\r\n}\r\nexport default Transactions","\r\nimport { Redirect } from \"react-router-dom\";\r\nconst { Component } = require(\"react\");\r\nclass OpenChat extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            input: '',\r\n            nameSent: false,\r\n            history: [],\r\n            ready: false,\r\n            chat: '',\r\n            currentName: this.props.name,\r\n            redirect: '',\r\n            noMessages: false\r\n        }\r\n        this.sendMessage = this.sendMessage.bind(this)\r\n        this.messageBeingWritten = this.messageBeingWritten.bind(this)\r\n        this.addMessage = this.addMessage.bind(this)\r\n        window.WebSocket = window.WebSocket || window.MozWebSocket;\r\n        if (!window.WebSocket) {\r\n            this.props.error(new Error(\"Selain ei tue chat-teknologiaa\"))\r\n        }\r\n        this.ws = this.props.ws\r\n    }\r\n    componentDidMount() {\r\n        // Go back if the page was refreshed\r\n        if (!this.props.chat)\r\n            this.setState({ redirect: <Redirect to=\"/\" /> })\r\n        else {\r\n            this.props.isReady(false)\r\n            // Fill character name if undefined\r\n            if (!this.state.currentName)\r\n                this.setState({ currentName: this.props.characters.find(character => character._id === this.props.characterId).name })\r\n            // Tell server that chat is open\r\n            if (this.ws.readyState !== 1) {\r\n                console.log('reconnecting')\r\n                this.props.wsInit()\r\n                    .then(this.ws.send(JSON.stringify({ chat: this.props.chat._id, type: 'openChat' })))\r\n            }\r\n            else {\r\n                this.ws.send(JSON.stringify({ chat: this.props.chat._id, type: 'openChat' }))\r\n            }\r\n\r\n            this.ws.onmessage = evt => {\r\n                // listen to data sent from the websocket server\r\n                const message = JSON.parse(evt.data)\r\n                if (message.type === 'message') {\r\n                    const newMessage = {\r\n                        time: new Date(message.data.time).toLocaleString(\"fi-FI\", { timeStyle: \"short\", dateStyle: \"medium\" }),\r\n                        text: message.data.text,\r\n                        author: message.data.author,\r\n                        authorId: message.data.authorId\r\n                    }\r\n                    this.setState(prevState => ({\r\n                        history: [...prevState.history, newMessage],\r\n                        noMessages: false\r\n                    }), () => { document.getElementById(\"message-container\").scrollTop = document.getElementById(\"message-container\").scrollHeight; return null })\r\n                }\r\n                if (message.type === 'history') {\r\n                    if (message.data.length === 0) {\r\n                        this.setState({ noMessages: true })\r\n                    }\r\n                    else {\r\n                        message.data.map(msg => this.setState(prevState => ({\r\n                            history: [...prevState.history, {\r\n                                time: new Date(msg.time).toLocaleString(\"fi-FI\", { timeStyle: \"short\", dateStyle: \"medium\" }),\r\n                                text: msg.text,\r\n                                author: msg.author,\r\n                                authorId: msg.authorId\r\n                            }]\r\n                        })))\r\n                        document.getElementById(\"message-container\").scrollTop = document.getElementById(\"message-container\").scrollHeight;\r\n                    }\r\n                    this.props.isReady(true)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    addMessage(message) {\r\n        if (message)\r\n            this.setState(prevState => ({\r\n                history: [...prevState.history, message]\r\n            }))\r\n    }\r\n    sendMessage(e) {\r\n        e.preventDefault()\r\n        const form = document.getElementById('msgForm')\r\n        form.classList.add(\"was-validated\")\r\n        if (form.checkValidity()) {\r\n            console.log(\"Sent \", this.state.input)\r\n            // Check that websocket is still open\r\n            if (this.ws.readyState !== 1) {\r\n                console.log('reconnect')\r\n                this.props.wsInit()\r\n                    .then(this.ws.send(JSON.stringify({ text: this.state.input, chat: this.props.chat, characterId: this.props.characterId, name: this.state.currentName, type: 'message' })))\r\n            }\r\n            else {\r\n                this.ws.send(JSON.stringify({ text: this.state.input, chat: this.props.chat, characterId: this.props.characterId, name: this.state.currentName, type: 'message' }))\r\n            }\r\n            this.setState({\r\n                input: ''\r\n            })\r\n        }\r\n    }\r\n    messageBeingWritten(event) {\r\n        this.setState({ input: event.target.value })\r\n    }\r\n    componentWillUnmount() {\r\n        this.props.clear()\r\n    }\r\n    render() {\r\n        let history = ''\r\n        if (this.state.history.length !== 0)\r\n            history = this.state.history.map(message =>\r\n                <div key={message._id} class={(message.author === this.state.currentName) ? \"toast show my-message w-75\" : \"toast show mb-3 w-75\"}>\r\n                    {/* Show user's own messages on right */}\r\n                    <div class=\"toast-header\">\r\n                        <strong class=\"me-auto\">{message.author}</strong>\r\n                        <small>{message.time}</small>\r\n                    </div>\r\n                    <div class=\"toast-body\">\r\n                        {message.text}\r\n                    </div>\r\n                </div>\r\n            )\r\n        let header = ''\r\n        if (this.props.chat && this.props.chat.participants)\r\n            // Filter current user name and then show other participants in header\r\n            header = this.props.chat.participants\r\n                .filter(a => a._id != this.props.characterId)\r\n                .map((participant, index, array) => index === array.length - 1 ? participant.name : participant.name + \", \")\r\n        let noMessagesTip = \"\"\r\n        if (this.state.noMessages)\r\n            noMessagesTip = <p class=\"text-center\">Tässä keskustelussa ei ole vielä viestejä. Lähetä yksi!</p>\r\n        return (\r\n            <main class=\"chat-container d-flex flex-column text-container container\">\r\n                {this.state.redirect}\r\n                <h2>{header}</h2>\r\n                <div class=\"overflow-auto messages-container p-3 flex-grow-1\" id=\"message-container\">\r\n                    {noMessagesTip}\r\n                    {history}\r\n                </div>\r\n\r\n                <form onSubmit={this.sendMessage} noValidate id=\"msgForm\"><div class=\"input-group\">\r\n                    <input class=\"form-control\" type=\"text\" value={this.state.input} onChange={this.messageBeingWritten} id=\"message-input\" required />\r\n                    <button class=\"btn btn-primary\" type=\"submit\">Lähetä</button>\r\n                    <div class=\"invalid-feedback\" id=\"messageFeedback\">\r\n                        Viesti voi sisältää ainoastaan kirjaimia, numeroita ja seuraavia merkkejä: ,.-\r\n                    </div>\r\n\r\n                </div></form>\r\n\r\n            </main>\r\n        )\r\n    }\r\n}\r\nexport default OpenChat","\r\nimport { Component } from 'react'\r\nimport { HashRouter as Router, Route, Link, Switch, Redirect } from \"react-router-dom\";\r\nimport Home from './Home.js'\r\nimport Info from './Info.js'\r\nimport AdminDashboard from './AdminDashboard.js'\r\nimport { Pay, PlayerInfo, PlayerDashboard } from './PlayerDashboard.js'\r\nimport { NewCharacter, NewUser } from './AdminDashboard.js'\r\nimport ChatList from './ChatList.js'\r\nimport Transactions from './Transactions.js'\r\nimport { List, ChatDots, Download } from 'react-bootstrap-icons'\r\nimport { Collapse, Dropdown, Toast } from 'bootstrap'\r\nimport '../css/custom.scss'\r\nimport OpenChat from './OpenChat.js';\r\nconst { REACT_APP_SERVER_URL, REACT_APP_WS_SERVER_URL } = process.env;\r\nclass App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      userId: '',\r\n      userName: '',\r\n      login: '',\r\n      userType: 'guest',\r\n      userCharacter: '',\r\n      characters: [],\r\n      selectedChat: '',\r\n      nameSent: false,\r\n      ready: false,\r\n      notifMsg: '',\r\n      notifSender: '',\r\n      ws: null,\r\n      selectedCharacter: {\r\n        name: '',\r\n        age: '',\r\n        gender: '',\r\n        player: '',\r\n        saldo: 0,\r\n        description: '',\r\n        mechanics: '',\r\n        plots: ''\r\n      },\r\n      selectedUser: '',\r\n      players: [],\r\n      defaultCharacter: {\r\n        name: '',\r\n        age: '',\r\n        gender: '',\r\n        player: '',\r\n        saldo: 0,\r\n        description: '',\r\n        mechanics: '',\r\n        plots: ''\r\n      },\r\n      loading: false\r\n    }\r\n\r\n    this.login = this.login.bind(this)\r\n    this.logout = this.logout.bind(this)\r\n    this.loginSuccess = this.loginSuccess.bind(this)\r\n    this.handleChange = this.handleChange.bind(this)\r\n    this.fetchCharacters = this.fetchCharacters.bind(this)\r\n    this.fetchPlayers = this.fetchPlayers.bind(this)\r\n    this.showError = this.showError.bind(this)\r\n    this.closeMenu = this.closeMenu.bind(this)\r\n    this.setReady = this.setReady.bind(this)\r\n    this.wsInit = this.wsInit.bind(this)\r\n  }\r\n  componentDidMount() {\r\n    // Check if login cookie\r\n    const cookies = decodeURIComponent(document.cookie)\r\n    const cookieArray = cookies.split(';')\r\n    cookieArray.forEach(cookie => {\r\n      while (cookie.charAt(0) === ' ') {\r\n        cookie = cookie.substring(1);\r\n      }\r\n      if (cookie.indexOf(\"login\") === 0) {\r\n        this.setState({ login: cookie.substring(6) }, () => this.login())\r\n        return;\r\n      }\r\n    })\r\n    this.fetchCharacters()\r\n  }\r\n  fetchPlayers() {\r\n    console.log(\"Fetching players\")\r\n    fetch(REACT_APP_SERVER_URL + \"user/\", { headers: { 'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com' } })\r\n      .then(res => res.json())\r\n      .then(result => result.filter(a => a.userType == \"player\"))\r\n      .then(result => result.sort(function (a, b) { return a.userName > b.userName })) // Sort by player name\r\n      .then(\r\n        (result) => {\r\n          // Save into state\r\n          this.setState({\r\n            players: result,\r\n            loading: false\r\n          });\r\n        })\r\n      .catch(error => this.showError(error, \"danger\"))\r\n  }\r\n  login(event) {\r\n    if (event)\r\n      event.preventDefault()\r\n\r\n    if (this.state.login) {\r\n      //Show loading\r\n      this.setState({ loading: true })\r\n      fetch(REACT_APP_SERVER_URL + \"user/\" + this.state.login, { headers: { 'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com' } })\r\n        .then(response => {\r\n          response.ok ? response.json().then(data => this.loginSuccess(data)) : this.showError(\"Kirjautuminen ei onnistunut. Tarkista oikeinkirjoitus.\", \"warning\")\r\n        })\r\n        .catch(error => { this.showError(error, \"danger\"); this.setState({ loading: false }) })\r\n    }\r\n  }\r\n  loginSuccess(data) {\r\n    this.closeMenu()\r\n    this.setState({\r\n      userId: data._id,\r\n      userName: data.userName,\r\n      userType: data.userType,\r\n      userCharacter: data.character,\r\n      warning: '',\r\n      loading: false\r\n    })\r\n    // create a cookie\r\n    document.cookie = \"login=\" + this.state.login\r\n    if (data.userType === \"player\") {\r\n      this.setState({ redirect: <Redirect to=\"/dashboard\" /> })\r\n    }\r\n    else {\r\n      this.setState({ redirect: <Redirect to=\"/admin\" /> })\r\n    }\r\n    this.wsInit()\r\n  }\r\n  logout() {\r\n    this.setState({\r\n      userId: '',\r\n      userType: 'guest',\r\n      userCharacter: '',\r\n      login: '',\r\n      loading: false,\r\n      redirect: <Redirect to=\"/\" />\r\n    })\r\n    // Remove login cookie\r\n    document.cookie = \"login=\"\r\n    this.state.ws.close()\r\n  }\r\n  handleChange(event) {\r\n    this.setState({ login: event.target.value })\r\n  }\r\n  fetchCharacters() {\r\n    console.log(\"Fetch characters\")\r\n    fetch(REACT_APP_SERVER_URL + \"character/\", { headers: { 'Access-Control-Allow-Origin': 'https://totentanz.herokuapp.com' } })\r\n      .then(res => res.json())\r\n      .then(result => result.sort(function (a, b) { return a.name > b.name })) // Sort by character name\r\n      .then(\r\n        (result) => {\r\n          // Save in state\r\n          this.setState({\r\n            characters: result,\r\n            loading: false\r\n          });\r\n        })\r\n      .catch(error => this.showError(error, \"danger\"))\r\n  }\r\n  showError(message, type) {\r\n    console.log(\"Showing error \", message)\r\n    // Prevent forever loading state\r\n    this.setState({ loading: false })\r\n    // Translate the most common errors\r\n    switch (message.message) {\r\n      case \"NetworkError when attempting to fetch resource.\":\r\n      case \"Failed to fetch\":\r\n        this.setState({ error: \"Yhteyttä palvelimeen ei saatu. Yritä hetken kuluttua uudelleen tai ota yhteys pelinjohtoon.\" }); break;\r\n      default:\r\n        this.setState({ error: message }); break;\r\n    }\r\n    // Show alert element\r\n    const alert = document.getElementById(\"errorMessage\")\r\n    alert.className = \"alert position-fixed bottom-0 start-50 translate-middle-x fade show\"\r\n    switch (type) {\r\n      case \"warning\": alert.classList.add(\"alert-warning\"); break;\r\n      case \"danger\": alert.classList.add(\"alert-danger\"); break;\r\n      case \"success\": alert.classList.add(\"alert-success\"); break;\r\n      default: break;\r\n    }\r\n    setTimeout(function () { alert.classList.remove('show') }, 7000);\r\n  }\r\n  closeMenu() {\r\n    // Only needed when using mid-size or smaller screen, since then a collapsing navbar will be used\r\n    if (window.screen.width < 992) {\r\n      const navbar = document.getElementById(\"navbar\")\r\n      const collapse = new Collapse(navbar)\r\n      collapse.hide()\r\n    }\r\n  }\r\n  setReady(state) {\r\n    if (state) { this.setState({ loading: false }); console.log(\"ready\") }\r\n    else { this.setState({ loading: true }); console.log(\"loading\") }\r\n  }\r\n  wsInit() {\r\n    // Websocket closes connection after 55 sec inactivity\r\n    console.log('Trying to connect to a websocket')\r\n    try {\r\n      this.setState({\r\n        ws: new WebSocket(REACT_APP_WS_SERVER_URL)\r\n      })\r\n    } catch (e) {\r\n      console.log(\"Websocket init failed. Error: \" + e)\r\n      this.showError(\"Yhteyttä chat-palveluun ei saatu muodostettua. Pikaviestit eivät välttämättä toimi.\", \"danger\")\r\n      return false\r\n    }\r\n    this.state.ws.onclose = () => {\r\n      console.log('disconnected')\r\n    }\r\n    this.state.ws.onmessage = evt => {\r\n      // listen to data sent from the websocket server\r\n      // But don't show notification if chat is open\r\n      const message = JSON.parse(evt.data)\r\n      console.log(\"Got a message: \", message)\r\n      if (this.state.selectedChat !== message.data.chat) {\r\n        const toast = new Toast(document.getElementById(\"notifToast\"))\r\n        this.setState({\r\n          notifMsg: message.data.text,\r\n          notifSender: message.data.author\r\n        }, toast.show())\r\n      }\r\n    }\r\n    this.state.ws.onopen = () => {\r\n      console.log('connected')\r\n      // Find username, either character name or \"admin\"\r\n      let user = this.state.characters.find(character => character._id === this.state.userCharacter)\r\n      let userName\r\n      if (user)\r\n        userName = user.name\r\n      else if (this.state.userType === \"admin\")\r\n        userName = \"admin\"\r\n      // If user has no character assigned, they cannot participate in chat\r\n      else {\r\n        console.log(\"No character assigned, closing websocket\")\r\n        this.state.ws.close()\r\n      }\r\n      // Send username to the websocket\r\n      if (userName && this.state.ws && this.state.ws.readyState === 1) {\r\n        this.state.ws.send(JSON.stringify({ text: userName, type: 'new', id: this.state.userCharacter }))\r\n        this.setState({ nameSent: true, ready: true })\r\n        return true\r\n      }\r\n      else {\r\n        return false\r\n      }\r\n\r\n    }\r\n    this.state.ws.onerror = (e) => this.showError(e, \"danger\")\r\n    return true\r\n  }\r\n  componentWillUnmount() {\r\n    if (this.state.ws)\r\n      this.state.ws.close()\r\n  }\r\n  render() {\r\n    let loginForm = <li class=\"nav-item\">\r\n      <form onSubmit={(e) => this.login(e)} class=\"w-100\">\r\n        <div class=\"input-group\">\r\n          <label for=\"login-input\" class=\"visually-hidden\">Kirjaudu sisään</label>\r\n          <input id=\"login-input\" type=\"text\" value={this.state.login} onChange={this.handleChange} class=\"form-control\"></input>\r\n          <button type=\"submit\" class=\"btn btn-primary\">Kirjaudu</button>\r\n        </div></form></li>\r\n    if (this.state.userId)\r\n      loginForm = <li class=\"nav-item\"><button type=\"submit\" onClick={this.logout} class=\"btn btn-primary\">Kirjaudu ulos</button></li>\r\n    let playerPage, adminPage = \"\"\r\n    if (this.state.userType === \"player\")\r\n      playerPage = <li class=\"nav-item\">\r\n        <Link to=\"/dashboard\" onClick={() => this.closeMenu()}>Pelaajan sivut</Link>\r\n      </li>\r\n    if (this.state.userType === \"admin\")\r\n      adminPage = <li class=\"nav-item\">\r\n        <Link to=\"/admin\" onClick={() => this.closeMenu()}>Hallintapaneeli</Link>\r\n      </li>\r\n    let loading\r\n    if (this.state.loading)\r\n      loading = <div class=\"spinner-border position-fixed top-50 start-50 loading \" role=\"status\">\r\n        <span class=\"visually-hidden\">Loading...</span>\r\n      </div>\r\n    return (\r\n      <Router>\r\n        <header class=\"navbar-container w-100\">\r\n          <nav class=\"navbar navbar-expand-lg main-nav container h-100\">\r\n            <div class=\"container-fluid\">\r\n              <Link class=\"navbar-brand\" to=\"/\">Totentanz</Link>\r\n              <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbar\" aria-controls=\"navbar\" aria-expanded=\"false\" aria-label=\"Valikko\">\r\n                <List />\r\n              </button>\r\n              <div class=\"collapse navbar-collapse justify-content-end\" id=\"navbar\">\r\n                <ul class=\"navbar-nav\">\r\n                  <li class=\"nav-item\">\r\n                    <Link to=\"/info\" onClick={() => this.closeMenu()}>Info</Link>\r\n                  </li>\r\n                  <li class=\"nav-item\">\r\n                    <Link to=\"/\" onClick={() => this.closeMenu()}>Ilmoittaudu</Link>\r\n                  </li>\r\n                  {playerPage}\r\n                  {adminPage}\r\n                  {loginForm}\r\n\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </nav>\r\n        </header>\r\n        {loading}\r\n        <div class=\"w-100 p-0\">\r\n          <div\r\n            class=\"alert alert-danger position-fixed bottom-0 start-50 translate-middle-x fade hidden\"\r\n            id=\"errorMessage\"\r\n            role=\"alert\"\r\n            aria-live=\"assertive\"\r\n            aria-atomic=\"true\"\r\n          >\r\n            {this.state.error}\r\n          </div>\r\n          {/* <div class=\"install-button position-fixed\" id=\"install-app\">\r\n            <Download />\r\n          </div> */}\r\n\r\n          <Switch>\r\n            <Route exact path=\"/\">\r\n              <Home />\r\n            </Route>\r\n            <Route exact path=\"/info\">\r\n              <Info />\r\n            </Route>\r\n            <Route exact path=\"/dashboard/info\">\r\n              <PlayerInfo character={this.state.characters.find(character => character._id === this.state.userCharacter)} />\r\n            </Route>\r\n            <Route exact path=\"/dashboard/pay\">\r\n              <Pay\r\n                characters={this.state.characters}\r\n                character={this.state.characters.find(character => character._id === this.state.userCharacter)}\r\n                fetchCharacters={this.fetchCharacters}\r\n                isReady={this.setReady}\r\n                error={this.showError} />\r\n            </Route>\r\n            <Route exact path=\"/dashboard/chat\">\r\n              <ChatList\r\n                characters={this.state.characters}\r\n                changeChat={e => this.setState({ selectedChat: e })}\r\n                fetchCharacters={this.fetchCharacters}\r\n                loggedCharacter={this.state.userCharacter}\r\n                type={this.state.userType}\r\n                error={this.showError}\r\n                isReady={this.setReady}\r\n              />\r\n            </Route>\r\n            <Route exact path=\"/dashboard\">\r\n              <PlayerDashboard\r\n                loggedCharacter={this.state.userCharacter}\r\n                characters={this.state.characters}\r\n                fetchCharacters={this.fetchCharacters}\r\n                userType={this.state.userType} />\r\n            </Route>\r\n            <Route exact path=\"/admin/newCharacter\">\r\n              <NewCharacter\r\n                character={this.state.selectedCharacter}\r\n                players={this.state.players}\r\n                fetchPlayers={this.fetchPlayers}\r\n                fetchCharacters={this.fetchCharacters}\r\n                clearSelectedCharacter={() => this.setState({ selectedCharacter: this.state.defaultCharacter })}\r\n                error={this.showError}\r\n                isReady={this.setReady}\r\n              />\r\n            </Route>\r\n            <Route exact path=\"/admin/newUser\">\r\n              <NewUser\r\n                characters={this.state.characters}\r\n                existingUser={this.state.players.find(player => player._id === this.state.selectedUser)}\r\n                clearSelectedUser={() => this.setState({ selectedUser: '' })}\r\n                fetchCharacters={this.fetchCharacters}\r\n                fetchPlayers={this.fetchPlayers}\r\n                error={this.showError}\r\n                isReady={this.setReady}\r\n              />\r\n            </Route>\r\n            <Route exact path=\"/admin/messages\">\r\n              <ChatList\r\n                characters={this.state.characters}\r\n                fetchCharacters={this.fetchCharacters}\r\n                changeChat={e => this.setState({ selectedChat: e })}\r\n                loggedCharacter={this.state.userCharacter}\r\n                type={this.state.userType}\r\n                error={this.showError}\r\n                isReady={this.setReady}\r\n              />\r\n            </Route>\r\n            <Route exact path=\"/admin/transactions\">\r\n              <Transactions\r\n                characters={this.state.characters}\r\n                fetchCharacters={this.fetchCharacters}\r\n                error={this.showError}\r\n                isReady={this.setReady}\r\n              />\r\n            </Route>\r\n            <Route exact path=\"/admin\">\r\n              <AdminDashboard\r\n                characters={this.state.characters}\r\n                fetchCharacters={this.fetchCharacters}\r\n                selectCharacter={e => this.setState({ selectedCharacter: e.target.id })}\r\n                selectUser={e => this.setState({ selectedUser: e.target.id })}\r\n                players={this.state.players}\r\n                fetchPlayers={this.fetchPlayers}\r\n                changeCharacter={e => this.setState({ selectedCharacter: e })}\r\n                changeUser={e => this.setState({ selectedUser: e })}\r\n                admin={this.state.userType}\r\n                error={this.showError}\r\n                isReady={this.setReady}\r\n              />\r\n            </Route>\r\n            <Route exact path=\"/chat\">\r\n              <OpenChat\r\n                chat={this.state.selectedChat}\r\n                characterId={this.state.userCharacter}\r\n                name={this.state.userType === \"admin\" ? \"admin\" : undefined}\r\n                characters={this.state.characters}\r\n                error={this.showError}\r\n                ws={this.state.ws}\r\n                isReady={this.setReady}\r\n                clear={() => this.setState({ selectedChat: '' })}\r\n                wsInit={this.wsInit}\r\n              />\r\n            </Route>\r\n\r\n          </Switch>\r\n        </div>\r\n        {this.state.redirect}\r\n        <div id=\"notifToast\" class=\"toast position-fixed\" role=\"alert\" aria-live=\"assertive\" aria-atomic=\"true\">\r\n          <div class=\"toast-header\">\r\n            <ChatDots />\r\n            <strong class=\"me-auto ml-1\">{this.state.notifSender}</strong>\r\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"toast\" aria-label=\"Close\"></button>\r\n          </div>\r\n          <div class=\"toast-body\">\r\n            {this.state.notifMsg}\r\n          </div>\r\n        </div>\r\n      </Router>\r\n    );\r\n  }\r\n}\r\nexport default App;\r\n\r\n\r\n\r\n\r\n\r\n\r\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './js/App';\nimport reportWebVitals from './reportWebVitals';\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nserviceWorkerRegistration.unregister();\n"],"sourceRoot":""}